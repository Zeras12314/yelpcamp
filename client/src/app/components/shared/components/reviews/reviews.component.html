<div class="review-container mt-3">
    <form class="mb-2 bg-glass p-3" [formGroup]="reviewForm">
        <h2>Leave a review</h2>
        <div>
            <fieldset class="starability-basic">
                <input type="radio" id="no-rate" class="input-no-rate" name="rating" value="0" checked
                    aria-label="No rating." />
                <input type="radio" id="first-rate1" name="rating" value="1" formControlName="rating" />
                <label for="first-rate1" title="Terrible">1 star</label>
                <input type="radio" id="first-rate2" name="rating" value="2" formControlName="rating" />
                <label for="first-rate2" title="Not good">2 stars</label>
                <input type="radio" id="first-rate3" name="rating" value="3" formControlName="rating" />
                <label for="first-rate3" title="Average">3 stars</label>
                <input type="radio" id="first-rate4" name="rating" value="4" formControlName="rating" />
                <label for="first-rate4" title="Very good">4 stars</label>
                <input type="radio" id="first-rate5" name="rating" value="5" formControlName="rating" />
                <label for="first-rate5" title="Amazing">5 stars</label>
            </fieldset>
        </div>

        <div class="mb-3">
            <label for="review-body" class="form-label">Review Text</label>
            <textarea formControlName="body" class="form-control glass-input" id="review-body" rows="3"
                placeholder="Write your review here..."></textarea>
        </div>
        <button type="button" class="flame-cta-fill" (click)="submitReview(campId())"
            [disabled]="!reviewForm.valid || (loadingCreate$ | async)">
            @if ((!(loadingCreate$ | async))) {
            Submit Review
            } @else {
            <span class="spinner-border spinner-border-sm" role="status"></span>
            Submitting...
            }
        </button>

    </form>
    @if(isReview$ | async){
    <app-messages></app-messages>
    }


    <!-- Reviews -->
    <div class="review-list-wrapper" [class.loading]="loadingDelete$ | async">
        <app-loading [loading]="loadingDelete$ | async"></app-loading>

        <div class="review-list  ">
            @for (review of campground.reviews ?? []; track $index) {
            <div class="card mb-2 bg-glass">
                <div class="container card-body ">
                    @let isReviewOwner = currentUserId === review?.author?._id;
                    <h5 class="card-title">{{review?.author?.username}}</h5>
                    <p class="starability-result" [attr.data-rating]="review?.rating">
                    </p>
                    <p class="card-text">{{ review.body }}</p>
                    @if(isReviewOwner){
                    <button class="flame-cta-fill delete" (click)="deleteReview(review._id)">Delete</button>
                    }
                </div>
            </div>
            } @if(campground.reviews.length === 0){
            <div class="card mb-2 bg-glass p-3">
                <div class="container card-body text-center">There are currently no reviews for this campground.</div>
            </div>
            }
        </div>
    </div>

</div>